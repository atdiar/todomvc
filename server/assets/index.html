<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	
	<base href="/">
	<link id ="todocss" rel="stylesheet" href="/css/todomvc.css">
	
	<script id="wasmVM" src="/wasm_exec.js"></script>
	<script id="goruntime">
        let wasmLoadedResolver, loadEventResolver;
        window.wasmLoaded = new Promise(resolve => wasmLoadedResolver = resolve);
        window.loadEventFired = new Promise(resolve => loadEventResolver = resolve);

        window.onWasmDone = function() {
            wasmLoadedResolver();
        }

        window.addEventListener('load', () => {
            console.log("load event fired...");
            loadEventResolver();
        });

        const go = new Go();
        WebAssembly.instantiateStreaming(fetch("/app.wasm"), go.importObject)
        .then((result) => {
            go.run(result.instance);
        });

        Promise.all([window.wasmLoaded, window.loadEventFired]).then(() => {
            setTimeout(() => {
                console.log("about to dispatch PageReady event...");
                window.dispatchEvent(new Event('PageReady'));
            }, 50);
        });
    </script>
	
	<!-- 
	<script src="gopherjs.js.map"></script>
	<script src="todomvc.js.map"></script>
	<script src="gopherjs.js"></script>
	<script id="todomvcjs" src="/js/todomvc.js"></script>
	-->
</head>

<body>
	

</body>

</html>
